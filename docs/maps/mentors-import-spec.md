# Mentors Import Spec (InspactorReport)
## Input File
- Expected source: InspactorReport-YYYY_MM_DD-XXXX.xlsx
- Columns we use (exact names may vary by file; see 'source_columns' block below)

## Field Mapping
- mentor_id ← "کد کارمندی پشتیبان"
- alias_code ← "کد پستی" (اگر خالی ⇒ null)
- gender_accepts ← "جنسیت"  (دختر=0، پسر=1)
- allowed_group_codes ← پارس از "شامل گروه های آزمایشی" با گرامر: 
  - مثال: `1,3,5,7:9` ⇒ [1,3,5,7,8,9]
  - قواعد: جداکننده‌ ها `,` یا `،` یا فاصله؛ بازه `a:b` شامل دو سر است؛ ارقام فارسی/انگلیسی مجاز
- school_whitelist ← از ستون‌های "نام مدرسه 1..4" (ترجیحاً کد مدرسه؛ اگر فقط نام داریم از Crosswalk نام→کد استفاده شود)
- is_school_limited ← true اگر alias_code تهی یا مدرسه‌ها پر باشند (و طبق قاعدهٔ ارجح: اگر هر دو وجود داشته باشند، 'مدرسه‌ای' فرض می‌شود)
- capacity_limit ← "تعداد تحت پوشش خاص" (اگر خالی ⇒ 60)
- assigned_baseline ← "تعداد داوطلبان تحت پوشش" (اگر خالی ⇒ 0)
- manager_id ← از "نام مدیر" با Crosswalk به کد مدیر (یا همان نام اگر یکتا)

## Precedence & Output Rule
- اگر هم alias_code و هم مدرسه‌ها وجود داشته باشد ⇒ **مدرسه‌ای** محسوب می‌شود و در خروجی اکسل، ستون «کد پستی جایگزین» با **mentor_id** پر می‌شود.

## Source Columns (auto-detected snapshot)
{
  "path": "/mnt/data/InspactorReport-1404_05_19-3570.xlsx",
  "sheets": [
    "InspactorList3570"
  ],
  "columns": [
    "کد نمایندگی",
    "کد کارمندی",
    "کد کارمندی پشتیبان",
    "جنسیت",
    "نام پشتیبان",
    "نام مدیر",
    "نام حوزه",
    "گروه آزمایشی",
    "پشتیبان خاص",
    "خدمات پشتیبانی",
    "برگزاری آزمون در روز آزمون",
    "بورسیه ی قلم چی",
    "نوع پشتیبان",
    "نام مدرسه 1",
    "نام مدرسه 2",
    "نام مدرسه 3",
    "نام مدرسه 4",
    "تعداد داوطلبان تحت پوشش",
    "کدپستی",
    "شامل گروه های آزمایشی",
    "تعداد تحت پوشش خاص",
    "غیر فعال",
    "تعداد مدارس تحت پوشش",
    "1حوزه در خود مدرسه ",
    "حوزه در خود مدرسه2 ",
    "3حوزه در خود مدرسه ",
    "4حوزه در خود مدرسه ",
    "در انتظار تخصیص پشتیبان",
    "امکان جذب دانش آموز",
    "1نوع مدرسه",
    "نوع مدرسه2",
    "3نوع مدرسه",
    "نوع مدرسه4",
    "1مقطع تحصیلی",
    "مقطع تحصیلی2",
    "3مقطع تحصیلی",
    "مقطع تحصیلی4",
    "1منطقه‌ی آموزش‌وپرورش",
    "2منطقه‌ی آموزش‌وپرورش",
    "3منطقه‌ی آموزش‌وپرورش",
    "منطقه‌ی آموزش‌وپرورش4"
  ]
}
