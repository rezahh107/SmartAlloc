{
  "form_id": 150,
  "hook_kept": "gform_after_submission_150",
  "hooks_removed": ["gform_after_submission"],
  "guard_key_format": "gf:entry:150:{entry_id}",
  "ttl_seconds": 3600,
  "ci_gates": [
    "phpunit-integration>=80% coverage",
    "patch-guard caps pass",
    "no generic hooks (grep gate)"
  ],
  "artifacts": [
    "IDEMPOTENCY_GUARD_ARTIFACT.json",
    "GF_CORE_UPDATE_ARTIFACT.json",
    "INTEGRATION_TEST_ARTIFACT.json"
  ],
  "notes": [
    "race-condition mitigated via guard before processing",
    "all forms except 150 must register their own specific hooks",
    "idempotency based on entry_id with 1-hour TTL"
  ],
  "verification_commands": {
    "no_generic_hooks": "grep -R 'add_action' src | grep 'gform_after_submission' | grep -v 'gform_after_submission_150' | wc -l",
    "coverage_check": "vendor/bin/phpunit --coverage-text | grep -E 'Lines:\\s+([8-9][0-9]|100)\\.'",
    "patch_guard": "bash scripts/patch-guard-check.sh --caps 'feature:files<=20,loc<=600'"
  },
  "implementation_phases": {
    "P1.A": "Planning and impact analysis",
    "P1.B": "IdempotencyGuard implementation",
    "P1.C": "Hook unification to single path",
    "P1.D": "Integration testing",
    "P1.E": "Documentation and manifest"
  }
}
