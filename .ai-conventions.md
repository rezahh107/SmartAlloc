# ü§ñ AI Development Conventions (SmartAlloc)

**Test-first, advisory by default.** Every change must consider QA, i18n/RTL,
security and deterministic output.

- Translation calls (`__`, `_e`, `_x`, etc.) require `php scripts/pot-refresh.php`
  and text-domain `smartalloc`.
- UI changes should recommend RTL/E2E snapshot:
  `E2E=1 E2E_RTL=1 npx playwright test tests/e2e/rtl-snapshot.spec.ts`.
- REST endpoints must enforce capability **and** nonce/signature checks.
- SQL queries must use `$wpdb->prepare()`.
- Scanners and enforcer run in advisory mode unless `--enforce` is specified.
- Produce deterministic artifacts (sorted JSON, UTC timestamps).

When adding tests or affecting translation/UI:
- Run `php scripts/coverage-import.php` and `php scripts/artifact-schema-validate.php`
  before `php scripts/ga-enforcer.php --profile=rc --junit`.
- The JUnit output always includes testcase `Artifacts.Schema`; advisory runs
  mark it skipped, GA enforcement fails when thresholds exceed.

Always append **post-change commands** in your answer:
```bash
php scripts/coverage-import.php
php scripts/artifact-schema-validate.php
php scripts/ga-enforcer.php --profile=rc --junit
# If UI changed:
E2E=1 E2E_RTL=1 npx playwright test tests/e2e/rtl-snapshot.spec.ts
```
Never assume a change is ‚Äútoo small‚Äù to impact QA.
